Creates random realistic simulated networks
========================================================


```{r load}
library(reshape)
library(bipartite)
library(unmarked)
```


#random matrix with 0's and 1's
```{r load}
simple <- function(m, n) {
    matrix(sample(0:1, m * n, replace = TRUE), m, n)
}
simple(10,7)
```



#Intent to reproduce Bluthgen et al 2008 model as described in Ecology 
"A bipartite ecological network describes the interac- tions between two communities containing I and J species. Networks can be displayed as I x J contingency tables, where each cell entry depicts the number of interactions recorded between a specific pair of species (Fig. 1). Our model of neutral encounter probabilities is based on the marginal totals of this contingency table, defining the total number of observation records per species as the vectors R1 and R2 (Fig. 1). Henceforth, we refer to R1 and R2 together as Rk (for k = [1, 2])."
"Patefield’s (1981) algorithm is implemented as function ‘‘r2dtable(100, R1, R2)’’ in R statistical software version 2.4.1 (R Development Core Team 2006)."
"In order to manipulate the skewness of Rk, we varied the standard deviation (r) of a log normal distribution, while maintaining the grand total number of observa- tions (m). Both R1 and R2 were generated by drawing series of I or J random numbers from a log normal distribution, with l = ln(M) – 0.5 r2, where l is the mean, r is the standard deviation, and M describes the sampling density of the network (mean number of observed interactions per cell), obtained from the grand total number of interactions recorded (m) as M = m/(IJ )."

```{r tests}
#define parameters
pol = 30
plant = 10
m = 600
M = m/(pol*plant)
mean = log(M)

I <- matrix(ncol = pol, nrow = 100)
J <- matrix(ncol = plant, nrow = 100)
for (i in 1:100){
teta = sample(c(1:10),1)
I[i,] <- rlnorm(pol, meanlog = mean - 0.5 * teta^2, sdlog = teta)
J[i,] <- rlnorm(plant, meanlog = mean - 0.5 * teta^2, sdlog = teta)
}

R1 <- apply(I, 2, median)
R2 <- apply(J, 2, median)

sum(R1)
sum(R2)

r2dtable(1, R1, R2)
#Not working
```
Is that the "by hand"" adjustment they do??

"Evenness approaches 0 for the most heterogeneous distribution and 1 for a perfectly homogenous distribution. R1 and/or R2 were often slightly readjusted in order to allow the evenness for both parties to become as similar as possible (ER1 ’ ER2) and to ensure that R (R1) = R (R2) = m."


#Very Dirty approach forcing R1 and R2 to sum the same

```{r tests2}

R1 <- c(1:30)
R2 <- c(1:10)

for (i in 1:29){
  R1[i] <- sample(1:15,1)
}
for (i in 1:9){
  R2[i] <- sample(20:30,1)
}

R1[30] <- (max(sum(R1[1:29]), sum(R2[1:9]))+10) - sum(R1[1:29])
R2[10] <- (max(sum(R1[1:29]), sum(R2[1:9]))+10) - sum(R2[1:9])

#hist(R1)
hist(R2)

V <- r2dtable(1, R2, R1)
#it works... but not exactly what I want...
```





